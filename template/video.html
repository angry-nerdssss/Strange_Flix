{% extends 'base.html' %}
{% load static %}
{% load comment_tags %}  {# Loading the template tag #}

{% block css %}
    <!-- video.js css -->
    <link href="https://vjs.zencdn.net/7.8.4/video-js.css" rel="stylesheet" /><!-- this is vjs css -->

    <!-- quality-selector css -->
    <link href="https://unpkg.com/@silvermine/videojs-quality-selector/dist/css/quality-selector.css" rel="stylesheet">


    <!-- my css -->
    <link rel="stylesheet" href="{% static 'css/video.css' %}">
{% endblock %}

{% block content %}

    <!-- video player -->
    <section class="video-section">
        <div class="video-div">
            <video id="videoPlayer" class="video-js vjs-big-play-centered" controls preload="auto" data-setup='{}'>
                <!-- <source src='{{ MEDIA_URL }}{{ video.videofile }}' type='video/mp4'> -->
                <source src='{{ MEDIA_URL }}{{ video.videofile }}' type='video/mp4' label = "720P" selected="true">
                <source src='{{ MEDIA_URL }}{{ video.videofile }}' type='video/mp4' label = "366P">
                <source src='{{ MEDIA_URL }}{{ video.videofile }}' type='video/mp4' label = "144P">
                
                
            </video>
            
        </div>
        <div class="video-actions-div">
            <h3 class="video-title">{{video.title}}</h3>
            <h6 class="video-info">{{video.category}} | Language | {{video.publish_date}} | Rating</h6>
            <h6 class="video-content">{{video.description}}</h6>
            <br><br>

            <input type="button" id="like" name="{{ video.slug }}" value="Like" />

<script>
$('#like').click(function(){
      $.ajax({
               type: "POST",
               url: "{% url 'svideo_like' %}",
               data: {'slug': $(this).attr('name'), 'csrfmiddlewaretoken': '{{ csrf_token }}'},
               dataType: "json",
               success: function(response) {
                      alert(response.message);
                      alert('Company likes count is now ' + response.likes_count);
                },
                error: function(rs, e) {
                       alert(rs.responseText);
                }
          }); 
    })
</script>
            {% render_comments video request %}  {# Render all the comments belong to the passed object "obj" #}

        </div>
    </section>


{% endblock %}

{% block javascript %}
    <script src="https://vjs.zencdn.net/7.8.4/video.js"></script>
    <script src="{% static 'js/hotkeys.js' %}"></script>
    <script src="https://unpkg.com/@silvermine/videojs-quality-selector/dist/js/silvermine-videojs-quality-selector.min.js"></script>
    <script type="text/javascript" src="{% static 'js/video.js' %}"></script>

{% endblock javascript %}
